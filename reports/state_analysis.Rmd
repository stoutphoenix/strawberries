---
title: "state_analysis"
output: html_document
date: "2025-10-27"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# State Analysis

## Load Data
```{r cars, echo=FALSE}
pacman::p_load(readr)
df <- read_csv('combined_data.csv')

```


```{r}
pacman::p_load(ggplot2)
# 6. SHIPMENT VOLUME VS PRODUCTION (SCATTER PLOT) with California regression
ggplot(df, aes(x = production_tons_total / 1000, y = total_tonnage / 1000, 
               color = state, shape = state)) +
  geom_point(size = 4, alpha = 0.7) +
  geom_abline(slope = 1, intercept = 0, linetype = "dashed", alpha = 0.5) +
  geom_smooth(data = df %>% filter(state == "CALIFORNIA"), 
              method = "lm", 
              se = TRUE,  # Show confidence interval
              linetype = "solid",
              linewidth = 1) +
  labs(
    title = "Shipment Volume vs Production Volume",
    subtitle = "Points above line indicate shipments > production; California regression shown",
    x = "Production (1000s of tons)",
    y = "Refrigerated Truck Shipments (1000s of tons)",
    color = "State",
    shape = "State"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    legend.position = "bottom"
  )

# Calculate the actual slopes and RÂ²
ca_model <- lm(total_tonnage ~ production_tons_total, 
               data = df %>% filter(state == "CALIFORNIA"))
fl_model <- lm(total_tonnage ~ production_tons_total, 
               data = df %>% filter(state == "FLORIDA"))

# Extract slope
ca_slope <- coef(ca_model)[2]
fl_slope <- coef(fl_model)[2]

print(paste("California slope:", round(ca_slope, 3)))
print(paste("Florida slope:", round(fl_slope, 3)))
```
This graph shows that the scale of strawberry production is vastly different between California and Florida, with California producing significantly more tons. It also shows that a higher majority of Florida production gets shipped to fresh market than California. Additionally, this graph shows the market adaptation of California to ship less fresh market strawberries through refrigerated trucks as production increases. This is shown through the slope of 0.507 when comparing tons shipped to tons produced. This could be due to more strawberry production going towards processed products, alternative distribution methods, or long-term storage to meet demand when supply diminishes.


